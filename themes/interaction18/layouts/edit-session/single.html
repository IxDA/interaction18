{{ partial "header.html" . }}
<div class="bordered-top"></div>
<main id="main">
	<section class="container container-m content spacer-2t-b">
		<div class="program-detail">
     
    {{ $data := getJSON $.Site.Params.programData }}

    {{ $programslug := .File.BaseFileName }}
    {{ range where $data.program "slug" "==" $programslug }}
        {{ $item := . }}
        <dl>
        	<dt>Title</dt>
        	<dd id="title">{{$item.title}}</dd>
		</dl>
    {{ end }}
		</div>

        <div id="info"><em></em></div>
        <div id="log"></div>

	</section>


	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//rawgit.com/victorjonsson/jquery-editable/master/jquery.editable.min.js"></script>
    <script type="text/javascript">

    $("dd").each(function() {
        var field=$(this).attr('id');
        var item=$(this);
        console.log("updating:"+field);
        $.get( "https://script.google.com/a/ixda.eu/macros/s/AKfycbxkosqjGNtLsuXFinK-HevSzy-8KDAjYDfbV299G3uZM5S4phs/exec",  { slug: "{{$programslug}}", field:field, pwd:"abc"  }, function( data ) {
            $(item).html( data );
        });
    });
    $("dl dd").editable({
    toggleFontSize : false,
    emptyMessage : '<em>Please write something...</em>',
    callback : function( data ) {
      console.log('Stopped editing ' + data.$el[0].nodeName );
        $.post( "https://script.google.com/a/ixda.eu/macros/s/AKfycbxkosqjGNtLsuXFinK-HevSzy-8KDAjYDfbV299G3uZM5S4phs/exec",
            { slug: "{{$programslug}}", field:data.$el[0].id, value: data.content, pwd:"abc"  },
            function( data ) { console.log(data); }).fail(function() {
            console.log("Failed request");
        });
      if( data.content )
        console.log('   * The text was changed')
    }
  });
    </script>
</main>
{{ partial "footer.html" . }}
